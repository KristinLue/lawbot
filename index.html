<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>青法通 AI 法律諮詢</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h2 { color: #003366; }
    input, button { width: 100%; padding: 10px; margin-top: 10px; }
    #answer { margin-top: 15px; white-space: pre-wrap; background: #f0f0f0; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>青法通 AI 法律小幫手</h2>
  <input type="text" id="question" placeholder="請輸入你的法律問題">
  <button onclick="ask()">送出</button>
  <button onclick="startListening()">🎤 語音輸入</button>
  <div id="answer">👇 輸入問題後會顯示答案</div>

  <script>
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'zh-TW';

    function startListening() {
      recognition.start();
      const q = document.getElementById('question');
      q.placeholder = '正在聆聽中…請說出你的問題';

      recognition.onresult = function(event) {
        q.value = event.results[0][0].transcript;
        q.placeholder = '請輸入你的法律問題';
      };

      recognition.onerror = function(event) {
        alert('語音辨識錯誤：' + event.error);
        q.placeholder = '請輸入你的法律問題';
      };
    }

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'zh-TW';
      speechSynthesis.speak(utterance);
    }

    async function ask() {
      const q = document.getElementById('question').value;
      const a = document.getElementById('answer');
      if (!q) return a.innerText = "請先輸入問題喔～";

      a.innerText = "AI 小幫手思考中...";

      const response = await fetch("https://api.chatanywhere.cn/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": "Bearer sk-antidebug"
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [
            { role: "system", content: "你是一位親切的台灣法律 AI 助理，請簡單明確回答民眾法律問題。" },
            { role: "user", content: q }
          ]
        })
      });

      const result = await response.json();
      const reply = result.choices?.[0]?.message?.content || "抱歉，AI 沒有回應。";
      a.innerText = reply;
      speak(reply);
    }
  </script>
</body>
</html>
